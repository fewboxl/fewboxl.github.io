<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>文档 | FewBox</title><link rel="shortcut icon" href="/favicon.ico"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><meta name="description"/><meta name="keywords"/><meta name="author"/><meta name="viewport"/><meta name="next-head-count" content="9"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/><link rel="preload" href="/_next/static/css/8229c51be3daddab.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8229c51be3daddab.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-94547de1949c56d7.js" defer=""></script><script src="/_next/static/chunks/framework-50116e63224baba2.js" defer=""></script><script src="/_next/static/chunks/main-47c0a74dd876f8ce.js" defer=""></script><script src="/_next/static/chunks/pages/_app-944373937886707a.js" defer=""></script><script src="/_next/static/chunks/121-1d15f2ee6740b70b.js" defer=""></script><script src="/_next/static/chunks/796-fc3760ecf0691118.js" defer=""></script><script src="/_next/static/chunks/pages/document-a839b1ea2bfaa378.js" defer=""></script><script src="/_next/static/naW9V0KzJIRYqVhWn_sKl/_buildManifest.js" defer=""></script><script src="/_next/static/naW9V0KzJIRYqVhWn_sKl/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div></div><div class="position-window-center"><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="display:none;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="position-self-custom" style="top:-undefined;right:-1em;bottom:-1.8em;left:-undefined;z-index:8888"><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="v-svg-circle font-size-extra-large red-background white-front white-border" style="border-width:2px;border-style:solid;border-color:white;padding:0.4em;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><path d="M150.83 32.212C148.17 29.55 144.888 28 141.341 28h-26.607c-3.77 0-7.198 1.55-9.859 4.212-2.442 2.66-3.875 6.095-3.875 9.865v99.445c0 3.77 1.431 6.961 3.873 9.621 2.661 2.44 6.089 3.635 9.861 3.635h26.607c3.547 0 6.829-1.195 9.49-3.634 2.661-2.661 4.168-5.851 4.168-9.622v-99.78c0-3.547-1.507-6.872-4.169-9.531v.001zm-22.791 142.573c-7.318 0-13.635 2.66-18.957 7.982-5.1 5.1-7.65 11.31-7.65 18.625 0 7.319 2.55 13.635 7.65 18.958 5.099 5.1 11.419 7.65 18.957 7.65 7.319 0 13.526-2.219 18.626-7.319 5.322-5.322 7.982-11.754 7.982-19.292 0-7.094-2.329-13.304-7.65-18.625-5.101-5.318-11.419-7.979-18.958-7.979z" fill="currentColor"></path></svg></div><div class="position-area-default undefined v-ybase red-background flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="border-radius:0.6em;padding:1.2em 2em 0.6em 2em;width:22em;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="position-area-right-top" style="z-index:9999"><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="v-svg-default font-size-super-small" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M36.604 78.148c-11.472-11.472-11.472-30.072 0-41.544 11.472-11.472 30.072-11.472 41.544 0l141.248 141.248c11.472 11.472 11.472 30.072 0 41.544-11.472 11.472-30.072 11.472-41.544 0L36.604 78.148z" fill="currentColor"></path><path d="M177.852 36.604c11.472-11.472 30.072-11.472 41.544 0 11.472 11.472 11.472 30.072 0 41.544L78.148 219.396c-11.472 11.472-30.072 11.472-41.544 0-11.472-11.472-11.472-30.072 0-41.544L177.852 36.604z" fill="currentColor"></path></svg></div><div class="flex-item v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:0.2em"><span class="flex-item v-label-center font-weight-black font-size-large" style="font-family:&#x27;Orbitron&#x27;, sans-serif"></span><a class="flex-item v-link" style="font-family:&#x27;Orbitron&#x27;, sans-serif" href="mailto:support@fewbox.com?subject= from FewBox&amp;body={Your Feedback Here}" target="_blank"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-center flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:0.6em"><span class="flex-item v-label" style="font-family:&#x27;Orbitron&#x27;, sans-serif"></span></div><span class="v-label font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">support@fewbox.com</span></a></div></div></div></div><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="margin:0 0 6em 0;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-zone-extra-large" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><header class="v-header" style="padding:2em 0;font-family:&#x27;Orbitron&#x27;, sans-serif"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><a class="flex-item" href="/"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" fill="none" class="v-svg-default white-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><path fill-rule="evenodd" clip-rule="evenodd" d="M28 100h128v56H55v16h29v56H28V100zm72 72v56h128V100h-56v56h27v16h-99zM84 28H28v56h56V28zm16 0v56h72V28h-72z" fill="currentColor"></path><path fill="currentColor" d="M28 228V28h56v200z"></path></svg></a><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:2em"><a class="flex-item" style="flex-grow:1" href="/"><span class="v-label light-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">首页</span></a><a class="flex-item v-link" style="flex-grow:1;font-family:&#x27;Orbitron&#x27;, sans-serif" href="/pricing" target="_self"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-center flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:0.6em"><span class="flex-item v-label" style="font-family:&#x27;Orbitron&#x27;, sans-serif"></span></div><span class="v-label light-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">定价</span></a><a class="flex-item" style="flex-grow:1" href="/support"><span class="v-label light-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">支持</span></a><a class="flex-item" style="flex-grow:1" href="/download"><span class="v-label light-background dark-front" style="border-radius:2em;padding:0.5em 0.8em;font-family:&#x27;Orbitron&#x27;, sans-serif">下载</span></a></div></div></header><section class="v-section" style="padding:5em 0;font-family:&#x27;Orbitron&#x27;, sans-serif"><div class="large-down-hidden v-xbase flex flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-flex-start flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:1em"><div class="flex-item v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="flex-grow:1;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:3em"><div id="getting-started" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>起步</h1>
<p>这个快速指南将告诉你如何使用FewBox来管理、安装和卸载你的云原生平台上的微服务。你还会得到一些关于如何设置自己的生产力的简单指导。</p></div><div id="prerequisites" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>先决条件</h1>
<ul>
<li>
<h2>安装Docker</h2>
<img src="./svgs/docker.svg" alt="docker"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 删除旧版本 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum remove docker-client </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-client-latest </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-common </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-latest </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-latest-logrotate </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-logrotate </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-selinux </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-engine-selinux </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">docker-engine
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> yum-utils
</span></span><span style="word-break:break-all;white-space:break-spaces">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> docker-ce
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> </span><span class="token" style="color:#DD4A68">docker</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> systemctl start </span><span class="token" style="color:#DD4A68">docker</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 设置 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> /etc/docker/daemon.json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span class="token" style="color:#690">EOF
</span></span><span style="word-break:break-all;white-space:break-spaces">{
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;log-driver&quot;: &quot;json-file&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;log-opts&quot;: {
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;max-size&quot;: &quot;100m&quot;
</span><span style="word-break:break-all;white-space:break-spaces">  },
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;storage-driver&quot;: &quot;overlay2&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;registry-mirrors&quot;: [
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;https://hub-mirror.c.163.com&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;https://mirror.baidubce.com&quot;
</span><span style="word-break:break-all;white-space:break-spaces">  ],
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;insecure-registries&quot;: [&quot;192.168.1.38:5000&quot;]
</span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#690">EOF</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Check</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> info </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">grep</span><span> Cgroup
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装Kubernetes</h2>
<img src="./svgs/kubernetes.svg" alt="kubernetes"/>
<blockquote>
<p>Kubeadm</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/yum.repos.d/kubernetes.repo
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">kubernetes</span><span class="token section" style="color:#999">]</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">name</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">Kubernetes</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">baseurl</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">enabled</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">1</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">gpgcheck</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># kubelet</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># yum --showduplicates list kubelet</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">yum remove kubelet
</span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> kubelet-1.19.16-0
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> kubeadm-1.19.16
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>镜像</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 同步Master镜像 (sync.sh) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 初始化参数</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">MY_REGISTRY</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>registry.cn-hangzhou.aliyuncs.com/google_containers
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># MY_REGISTRY=mirrorgcrio</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 kube </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">ETCD_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 etcd </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">PAUSE_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 pause </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">COREDNS_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 coredns </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images from &quot;</span><span class="token" style="color:#e90">$MY_REGISTRY</span><span class="token" style="color:#690">&quot; ......&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm config images list
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 添加标签</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span> k8s.gcr.io/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span> k8s.gcr.io/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span> k8s.gcr.io/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images FINISHED.&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 同步Woker镜像 (sync.sh) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 初始化参数</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">MY_REGISTRY</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>registry.cn-hangzhou.aliyuncs.com/google_containers
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># MY_REGISTRY=mirrorgcrio</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 kube </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">ETCD_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 etcd </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">PAUSE_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 pause </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">COREDNS_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 coredns </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images from &quot;</span><span class="token" style="color:#e90">$MY_REGISTRY</span><span class="token" style="color:#690">&quot; ......&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm config images list
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 添加标签</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span> k8s.gcr.io/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span> k8s.gcr.io/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images FINISHED.&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Cluster Network</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 设置 (网络) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 防火墙</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop firewalld
</span><span style="word-break:break-all;white-space:break-spaces">systemctl disable firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 将SELinux设置为允许模式（有效地禁用它）。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sudo</span><span> setenforce </span><span class="token" style="color:#905">0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sudo</span><span> </span><span class="token" style="color:#DD4A68">sed</span><span> -i </span><span class="token" style="color:#690">&#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27;</span><span> /etc/selinux/config
</span></span><span style="word-break:break-all;white-space:break-spaces">swapoff -a
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sed</span><span> -i </span><span class="token" style="color:#690">&#x27;/ swap / s/^\(.*\)$/#\1/g&#x27;</span><span> /etc/fstab
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 桥接</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span class="token" style="color:#690">EOF</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#DD4A68">sudo</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#DD4A68">tee</span><span class="token bash" style="color:#999"> /etc/sysctl.d/k8s.conf</span><span class="token" style="color:#690">
</span></span><span style="word-break:break-all;white-space:break-spaces">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="word-break:break-all;white-space:break-spaces">net.bridge.bridge-nf-call-iptables = 1
</span><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#690">EOF</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Check</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">sysctl --system
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 代理 (Kubelet) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl daemon-reload
</span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> kubelet </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> systemctl restart kubelet
</span></span><span style="word-break:break-all;white-space:break-spaces">journalctl -xefu kubelet
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Kubernetes</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装Master ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Multiple Eth need --apiserver-advertise-address</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubeadm init --pod-network-cidr</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">10.244</span><span>.0.0/16 --kubernetes-version</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">1.19</span><span>.16
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装Worker ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 打印连接脚本</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm token create --print-join-command
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 链接Master</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubeadm </span><span class="token" style="color:#DD4A68">join</span><span> </span><span class="token" style="color:#905">172.17</span><span>.0.1:6443 --token vv4prq.ezm481v2k0oa0273 --discovery-token-ca-cert-hash sha256:bd34337dcab22ce02049d1f98dc73a96729f1a3b9c9d80a3d76e175af1db4e21
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 网络 (Flannel) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 下载</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">wget</span><span> https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 更改 &quot;net-conf.json &gt; Network&quot; 为 kubernetes podCIDR 10.244.0.0/16</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl cluster-info dump </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">grep</span><span> -m </span><span class="token" style="color:#905">1</span><span> cluster-cidr
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">vi</span><span> kube-flannel.yml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f kube-flannel.yml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># start.sh</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span> </span><span class="token assign-left" style="color:#e90">KUBECONFIG</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>/etc/kubernetes/admin.conf
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">alias</span><span> </span><span class="token assign-left" style="color:#e90">k</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>kubectl  </span><span class="token" style="color:slategray">#~/.bashrc</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">source</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#999">(</span><span>kubectl completion </span><span class="token" style="color:#DD4A68">bash</span><span class="token" style="color:#999">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">source</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#999">(</span><span>kubectl completion </span><span class="token" style="color:#DD4A68">bash</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">sed</span><span>   s/kubectl/k/g</span><span class="token" style="color:#999">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">alias</span><span> </span><span class="token assign-left" style="color:#e90">kcd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&#x27;kubectl config set-context $(kubectl   config current-context) --namespace&#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span> </span><span class="token assign-left" style="color:#e90">CALICO_DATASTORE_TYPE</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>kubernetes
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span>   </span><span class="token assign-left" style="color:#e90">CALICO_KUBECONFIG</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>/etc/kubernetes/admin.conf
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># export PATH=$PATH:/root/istio-1.6.2/bin/</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 容许tab按键帮助</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum -y </span><span class="token" style="color:#DD4A68">install</span><span> bash-completion
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">bash</span><span> /usr/share/bash-completion/bash_completion
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">bash</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 检测Kubernetes状态 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get cs
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># scheduler            Unhealthy   Get &quot;http://127.0.0.1:10251/healthz&quot;: dial tcp 127.0.0.1:10251: connect:   connection refused   </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># controller-manager   Unhealthy   Get &quot;http://127.0.0.1:10252/healthz&quot;: dial tcp 127.0.0.1:10252: connect:   connection refused</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Solution: need to remove &quot;--port=0&quot; in kube-controller-manager.yaml  kube-scheduler.yaml   /etc/kubernetes/manifests </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl restart kubelet.service
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 资源 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl describe </span><span class="token" style="color:#DD4A68">node</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl describe </span><span class="token" style="color:#DD4A68">node</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">grep</span><span> -E </span><span class="token" style="color:#690">&#x27;((Name|Roles):\s{6,})|(\s+(memory|cpu)\s+[0-9]+\w{0,2}.+%\))&#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 清理 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl drain </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>node name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> --delete-local-data --force --ignore-daemonsets
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm reset
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cd</span><span> /etc/cni/net.d/
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># remove /etc/cni/net.d/</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">lsof</span><span> -i :6443</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">grep</span><span> -v </span><span class="token" style="color:#690">&quot;PID&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">awk</span><span> </span><span class="token" style="color:#690">&#x27;{print &quot;kill -9&quot;,$2}&#x27;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">sh</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>iptables -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -t nat -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -t mangle -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -X
</span></span><span style="word-break:break-all;white-space:break-spaces">ipvsadm -C
</span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl delete </span><span class="token" style="color:#DD4A68">node</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>node name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 容许Master部署 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl taint nodes --all node-role.kubernetes.io/master-
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Metric ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull bitnami/metrics-server:0.6.1
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag bitnami/metrics-server:0.6.1 k8s.gcr.io/metrics-server/metrics-server:v0.6.1
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">yaml</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-yaml" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Disable Metric Security ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#07a">spec</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token key" style="color:#07a">containers</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:#999">-</span><span> </span><span class="token key" style="color:#07a">args</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>cert</span><span class="token" style="color:#999">-</span><span>dir=/tmp
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>secure</span><span class="token" style="color:#999">-</span><span>port=4443
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token key" style="color:#07a">command</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> /metrics</span><span class="token" style="color:#999">-</span><span>server
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>insecure</span><span class="token" style="color:#999">-</span><span>tls=true
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>preferred</span><span class="token" style="color:#999">-</span><span>address</span><span class="token" style="color:#999">-</span><span>types=InternalIP
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token key" style="color:#07a">image</span><span class="token" style="color:#999">:</span><span> k8s.gcr.io/metrics</span><span class="token" style="color:#999">-</span><span>server/metrics</span><span class="token" style="color:#999">-</span><span>server</span><span class="token" style="color:#999">:</span><span>v0.3.7
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">yaml</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-yaml" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Disable Metric Security ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#07a">args</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>cert</span><span class="token" style="color:#999">-</span><span>dir=/tmp
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>secure</span><span class="token" style="color:#999">-</span><span>port=4443
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>preferred</span><span class="token" style="color:#999">-</span><span>address</span><span class="token" style="color:#999">-</span><span>types=InternalIP</span><span class="token" style="color:#999">,</span><span>ExternalIP</span><span class="token" style="color:#999">,</span><span>Hostname
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>use</span><span class="token" style="color:#999">-</span><span>node</span><span class="token" style="color:#999">-</span><span>status</span><span class="token" style="color:#999">-</span><span>port
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>insecure</span><span class="token" style="color:#999">-</span><span>tls </span><span class="token" style="color:slategray"># 添加这一行（新版本）。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 检测Metric ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl </span><span class="token" style="color:#DD4A68">top</span><span> </span><span class="token" style="color:#DD4A68">node</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl </span><span class="token" style="color:#DD4A68">top</span><span> pod
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>Install Istio</h2>
<img src="./svgs/istio.svg" alt="istio"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -L https://istio.io/downloadIstio </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">sh</span><span> -
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl </span><span class="token" style="color:#DD4A68">install</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 插件 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/prometheus.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/grafana.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/jaeger.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/kiali.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 概况 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># istioctl install --set profile=demo</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">istioctl profile list
</span><span style="word-break:break-all;white-space:break-spaces">istioctl profile dump default
</span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl profile </span><span class="token" style="color:#DD4A68">diff</span><span> default demo
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 验证 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl manifest generate </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token environment" style="color:#905">$HOME</span><span>/generated-manifest.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl verify-install -f </span><span class="token environment" style="color:#905">$HOME</span><span>/generated-manifest.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 卸载 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 所有</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">istioctl x uninstall --purge
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 控制平面</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl x uninstall </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>your original installation options</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl manifest generate </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>your original installation options</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> kubectl delete -f -
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 命名空间</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl delete namespace istio-system
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装NFS</h2>
<blockquote>
<p>NFS</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum -y </span><span class="token" style="color:#DD4A68">install</span><span> nfs-utils rpcbind
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">mkdir</span><span> -p /data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">chmod</span><span> </span><span class="token" style="color:#905">755</span><span> /data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">vi</span><span> /etc/exports
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># /etc/exports</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># /data/k8s 192.168.1.0/24(rw,sync,no_root_squash) // /data/k8s *(rw,sync,no_root_squash)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -v telnet://192.168.1.38:2049
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 启动服务 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> rpcbind
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> nfs
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl start rpcbind
</span><span style="word-break:break-all;white-space:break-spaces">systemctl start nfs
</span><span style="word-break:break-all;white-space:break-spaces">rpcinfo -p
</span><span style="word-break:break-all;white-space:break-spaces">exportfs -r
</span><span style="word-break:break-all;white-space:break-spaces">exportfs
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Kubernetes</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 重要!!! 需要安装在Master节点（可选）和Worker节点。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nfs-utils
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Test</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 客户端 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nfs-common nfs-utils -y
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 挂载 &amp; 卸载 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">mount</span><span> -t nfs </span><span class="token" style="color:#905">192.168</span><span>.1.38:/NFS/k8s /mount/nfs </span><span class="token" style="color:slategray"># Master和Worker节点，都指向NFS服务器。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mount -t nfs 192.168.1.38:/data/k8s /mount/nfs # Master和Worker节点，都指向NFS服务器。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mount -t nfs 192.168.1.38:/NFS/nginx /mount/nfs</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -v telnet://192.168.1.38:2049
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">umount</span><span> -f -l /mount/data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装Nginx</h2>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nginx
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 设置防火墙</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl status firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --add-port</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">80</span><span>/tcp --permanent
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">#user  nginx;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#user  root; # Permission Issue.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Defines which Linux system user will own and run the Nginx server</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">worker_processes  1;
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Referes to single threaded process. Generally set to be equal to the number of CPUs or cores.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#error_log  logs/error.log; #error_log  logs/error.log  notice;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Specifies the file where server logs.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#pid        logs/nginx.pid;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#nginx will write its master process ID(PID).</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">events {
</span><span style="word-break:break-all;white-space:break-spaces">    worker_connections  1024;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># worker_processes and worker_connections allows you to calculate maxclients value:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># max_clients = worker_processes * worker_connections</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">http {
</span><span style="word-break:break-all;white-space:break-spaces">    ssl_certificate /etc/ssl/fewbox.crt;
</span><span style="word-break:break-all;white-space:break-spaces">    ssl_certificate_key /etc/ssl/fewbox.key;
</span><span style="word-break:break-all;white-space:break-spaces">    upstream istio {
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.3:30815;
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.4:30815;
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.5:30815;
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    include       mime.types;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># anything written in /opt/nginx/conf/mime.types is interpreted as if written inside the http { } block</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    default_type  application/octet-stream;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_connect_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_send_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_read_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    client_max_body_size 200M;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_connect_timeout       600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_send_timeout          600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_read_timeout          600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_http_version 1.1;
</span><span style="word-break:break-all;white-space:break-spaces">    send_timeout                600;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#access_log  logs/access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    sendfile        on;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># If serving locally stored static files, sendfile is essential to speed up the server,</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># But if using as reverse proxy one can deactivate it</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#tcp_nopush     on;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># works opposite to tcp_nodelay. Instead of optimizing delays, it optimizes the amount of data sent at   once.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#keepalive_timeout  0;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    keepalive_timeout  65;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># timeout during which a keep-alive client connection will stay open.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    gzip  on;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_min_length 1k;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_buffers 4 16k;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_comp_level 5;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_types gzip_types text/plain application/javascript application/x-javascript text/css   application/xml text/javascript application/x-httpd-php;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_http_version 1.1;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_vary on;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_proxied any;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_disable msie6;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># tells the server to use on-the-fly gzip compression.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    server {
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># You would want to make a separate file with its own server block for each virtual domain</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># on your server and then include them.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        listen       80;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#tells Nginx the hostname and the TCP port where it should listen for HTTP connections.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># listen 80; is equivalent to listen *:80;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        server_name  _;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># lets you doname-based virtual hosting</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        charset utf-8;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#access_log  logs/host.access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        return 302 https://$server_name$request_uri;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#error_page  404              /404.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># redirect server error pages to the static page /50x.html</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        error_page   500 502 503 504  /50x.html;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token key" style="color:#690">location</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/50x.html {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            root   html;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    proxy_pass   http://127.0.0.1;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    root           html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_pass   127.0.0.1:9000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_index  index.php;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    include        fastcgi_params;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># deny access to .htaccess files, if Apache&#x27;s document root</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># concurs with nginx&#x27;s one</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ /\.ht {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    deny  all;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    server
</span><span style="word-break:break-all;white-space:break-spaces">    {
</span><span style="word-break:break-all;white-space:break-spaces">        listen 443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces">        server_name _;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header Host  $host;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header X-Forwarded-For $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-Real-IP $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Host $host:$server_port;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-NginX-Proxy true;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_pass http://istio;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    server
</span><span style="word-break:break-all;white-space:break-spaces">    {
</span><span style="word-break:break-all;white-space:break-spaces">        listen 8443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces">        server_name _;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header Host $host;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header X-Forwarded-For $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_pass https://172.17.6.3:6443; # Your Api Server Address
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    server {
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># You would want to make a separate file with its own server block for each virtual domain</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># on your server and then include them.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        listen 7443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#tells Nginx the hostname and the TCP port where it should listen for HTTP connections.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># listen 80; is equivalent to listen *:80;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        server_name  _;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># lets you doname-based virtual hosting</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        charset utf-8;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#access_log  logs/host.access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#The location setting lets you configure how nginx responds to requests for resources within the   server.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#root   /usr/share/nginx/html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#index  index.html index.htm;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#try_files $uri /index.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-Real-IP $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Host $host:$server_port;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-NginX-Proxy true;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_pass http://istio;
</span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_set_header Host  $host;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_set_header X-Forwarded-For $remote_addr;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_pass http://istio;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#error_page  404              /404.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># redirect server error pages to the static page /50x.html</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        error_page   500 502 503 504  /50x.html;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token key" style="color:#690">location</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/50x.html {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            root   html;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    proxy_pass   http://127.0.0.1;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    root           html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_pass   127.0.0.1:9000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_index  index.php;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    include        fastcgi_params;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># deny access to .htaccess files, if Apache&#x27;s document root</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># concurs with nginx&#x27;s one</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ /\.ht {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    deny  all;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># another virtual host using mix of IP-, name-, and port-based configuration</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#server {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    listen       8000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    listen       somename:8080;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    server_name  somename  alias  another.alias;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    location / {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#        root   html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#        index  index.html index.htm;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    }</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装SSL</h2>
<blockquote>
<p>Let&#x27;s Encrypt (<a href="https://letsencrypt.org/">https://letsencrypt.org/</a>)</p>
<p>Cerbot (<a href="https://certbot.eff.org/">https://certbot.eff.org/</a>)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 生成带有密码的SSL私钥 (fewbox-pw.key)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>openssl genrsa -des3 -out fewbox-pw.key </span><span class="token" style="color:#905">2048</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看带有密码的私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl rsa -text -in fewbox-pw.key
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看带有密码的私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> fewbox-pw.key
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成CSR(fewbox.csr)证书签名请求</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl req -new -key fewbox-pw.key -out fewbox.csr
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看CSR</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl req -text -in fewbox.csr -noout
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成CRT（ fewbox.crt）证书</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>openssl x509 -req -days </span><span class="token" style="color:#905">365</span><span> -in fewbox.csr -signkey fewbox-pw.key -out fewbox.crt
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成SSL私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl rsa -in fewbox-pw.key -out fewbox.key
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>设置防火墙</h2>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 查看状态</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl status firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 重启</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 开机启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> firewalld
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 禁止开机启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">sytemctl disable firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl start firewalld 
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 关闭</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看区域</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --get-active-zones
</span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --get-zone-of-interface</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>enp0s3
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看拒绝数据包状态</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --query-panic
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拒绝所有数据包</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --panic-on
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 容许所有数据包</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --panic-off
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看端口号</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --list-ports
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 打开端口</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --add-port</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">80</span><span>/tcp --permanent
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 其他</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --zone=public --add-interface=eth0 (FOREVER add &#x27;--permanent&#x27; and then reload firewall)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --set-default-zone=public (Valiable immediately, no need rebot)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --reload orfirewall-cmd --complete-reload (No1 no need diconnect, No2 need disconnect as reboot)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装FRP (可选)</h2>
<blockquote>
<p>下载</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># https://github.com/fatedier/frp/releases</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># amd64</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">wget</span><span> https://github.com/fatedier/frp/releases/download/v0.44.0/frp_0.44.0_linux_amd64.tar.gz
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>服务端 (拥有公网IP)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># https://gofrp.org/docs/examples/ frps.ini</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">common</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">bind_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">vhost_http_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">8080</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">vhost_https_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">8081</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">log_file</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">console</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_addr</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">0.0.0.0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7500</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_user</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">fewbox</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_pwd</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Pwd}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">token</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Token}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">max_pool_count</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">50</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/systemd/system/frps.service
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Unit</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Description</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">frp server</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">After</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">network.target syslog.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Wants</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">network.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Service</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Type</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">simple</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">ExecStart</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/path/to/frps -c /path/to/frps.ini</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Install</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">WantedBy</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">multi-user.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>systemctl start frps
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop frps
</span><span style="word-break:break-all;white-space:break-spaces">systemctl restart frps
</span><span style="word-break:break-all;white-space:break-spaces">systemctl status frps
</span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> frps
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>客户端 (内部机器出口)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull fatedier/frpc
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">common</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">server_addr</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Server IP}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">server_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">token</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Token}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">web</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">type</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">http</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">local_ip</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Local IP: EG. nginx}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">local_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">5000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">custom_domains</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">*.fewbox.com</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<h3><strong>NAS</strong></h3>
<p>Command: -c /frpc/frpc.ini</p>
<p>Endpoint: /usr/bin/frpc</p>
<p>Share Folder: /DevOps/frpc /frpc</p>
</blockquote>
</li>
<li>
<h2>安装esxi (可选)</h2>
<blockquote>
<p><a href="https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=gn51y&amp;lwp=rt">https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=gn51y&amp;lwp=rt</a></p>
</blockquote>
</li>
</ul></div><div id="packing-table" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装包装台</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>域，NFS，名称空间，服务账户，集群角色绑定，打包表</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 安装</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">.</span><span> ./fewbox-install.sh
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 检测</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get ns fewbox-system
</span><span style="word-break:break-all;white-space:break-spaces">k get sa fewbox
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get clusterrolebinding fewbox </span><span class="token" style="color:slategray"># cluster-admin - fewbox/fewbox-admin</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get cm packingtable
</span><span style="word-break:break-all;white-space:break-spaces">k get crd packingtables.fewbox.com
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy packingtable
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="infrastructure" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装基础设施</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>名称空间，服务账户，集群角色，集群角色绑定，NFS供应者，NFS存储类</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>k create -f ./component/infrastructure/fewbox-infrastructure.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>kcd fewbox
</span></span><span style="word-break:break-all;white-space:break-spaces">k get ns fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get sa nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrole nfs-client-provisioner-runner
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrolebinding run-nfs-client-provisioner-fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces">k get sc managed-nfs-storage
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="third-party" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装第三方</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>RabbitMQ: CRD, ClusterRole, Service Account, Role Binding, Cluster Role Binding, Deployment, Virtual Service, RMQ</p>
<p>MySQL: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
<p>Redis: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
<p>MongoDB: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/kubernetes/manifests/kube-apiserver.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Under here:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#spec:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#containers:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#- command:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#  - kube-apiserver</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Add this line:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#- --feature-gates=RemoveSelfLink=false</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>k get pvc mysql
</span></span><span style="word-break:break-all;white-space:break-spaces">k get pvc npmregistry
</span><span style="word-break:break-all;white-space:break-spaces">k get pvc redis
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get </span><span class="token" style="color:#DD4A68">pv</span><span> </span><span class="token" style="color:slategray"># From PVC</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get cm npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>k get cm rabbitmq-cluster-operator-leader-election  </span><span class="token" style="color:slategray">#??</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get deploy mysql
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get deploy npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get deploy rabbitmq-cluster-operator
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy redis
</span><span style="word-break:break-all;white-space:break-spaces">k get svc mysql
</span><span style="word-break:break-all;white-space:break-spaces">k get svc npmregistry
</span><span style="word-break:break-all;white-space:break-spaces">k get svc redis
</span><span style="word-break:break-all;white-space:break-spaces">k get dr mysql
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get dr npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get dr redis
</span><span style="word-break:break-all;white-space:break-spaces">k get vs mysql
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get vs npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get vs redis
</span><span style="word-break:break-all;white-space:break-spaces">k get vs rabbitmq-client
</span><span style="word-break:break-all;white-space:break-spaces">k get crd rabbitmqclusters.rabbitmq.com
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrole rabbitmq-cluster-operator-role
</span><span style="word-break:break-all;white-space:break-spaces">k get sa rabbitmq-cluster-operator
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get rolebinding rabbitmq-cluster-leader-election-rolebinding </span><span class="token" style="color:slategray"># rabbitmq-cluster-leader-election-role -   rabbitmq-cluster-operator</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get clusterrolebinding rabbitmq-cluster-operator-rolebinding-fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get vs rabbitmq-client
</span><span style="word-break:break-all;white-space:break-spaces">k get rmq fewbox
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 测试MySQL</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>k </span><span class="token" style="color:#DD4A68">exec</span><span> -it fewbox-mysql-0 </span><span class="token" style="color:#DD4A68">bash</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># SQL &gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mysqlsh fewbox@localhost --sql</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># set global read_only=0;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k port-forward service/fewbox-mysql-instances mysql
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="foundation" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装基本组件</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 数据库模式</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k create -f ./component/foundation/fewbox-foundation-schema.yaml
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 应用</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k create -f ./component/foundation/fewbox-foundation.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="how-to-use" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>怎样使用</h1>
<blockquote>
<p>即将开放</p>
<p><a href="./service"><strong>联系我们</strong></a></p>
</blockquote></div><div id="about-us" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>关于我们</h1>
<p>由一个曾在大型公司和创业公司（联想、JD、BoostSolutions）担任过架构师的老家伙创立，但现在我正在创建一个小而美的公司。</p>
<p>我们正在为那些想要变得聪明的客户建立智能套件。</p></div></div><div class="flex-item v-boundary" style="width:48em;font-family:&#x27;Orbitron&#x27;, sans-serif"><div class="position-window-right"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:2em"><div class="flex-item v-line-vertical dark-background" style="flex-grow:1;height:24em;width:1px;font-family:&#x27;Orbitron&#x27;, sans-serif"></div><div class="flex-item v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="flex-grow:1;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:1.6em"><a class="flex-item" href="/document#getting-started"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">入门</div></a><a class="flex-item" href="/document#prerequisites"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">先决条件</div></a><a class="flex-item" href="/document#packing-table"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">包装台</div></a><a class="flex-item" href="/document#infrastructure"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">基础设施</div></a><a class="flex-item" href="/document#third-party"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">第三方</div></a><a class="flex-item" href="/document#foundation"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">基本组件</div></a><a class="flex-item" href="/document#how-to-use"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">怎样使用</div></a><a class="flex-item" href="/document#about-us"><div class="v-label font-weight-extra-bold font-size-large blue-front" style="width:12em;font-family:&#x27;Orbitron&#x27;, sans-serif">关于我们</div></a></div></div></div></div></div><div class="large-up-hidden v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:3em"><div id="getting-started" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>起步</h1>
<p>这个快速指南将告诉你如何使用FewBox来管理、安装和卸载你的云原生平台上的微服务。你还会得到一些关于如何设置自己的生产力的简单指导。</p></div><div id="prerequisites" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>先决条件</h1>
<ul>
<li>
<h2>安装Docker</h2>
<img src="./svgs/docker.svg" alt="docker"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 删除旧版本 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum remove docker-client </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-client-latest </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-common </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-latest </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-latest-logrotate </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-logrotate </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-selinux </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>docker-engine-selinux </span><span class="token" style="color:#999">\</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">docker-engine
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> yum-utils
</span></span><span style="word-break:break-all;white-space:break-spaces">yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
</span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> docker-ce
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> </span><span class="token" style="color:#DD4A68">docker</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> systemctl start </span><span class="token" style="color:#DD4A68">docker</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 设置 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> /etc/docker/daemon.json </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span class="token" style="color:#690">EOF
</span></span><span style="word-break:break-all;white-space:break-spaces">{
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;],
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;log-driver&quot;: &quot;json-file&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;log-opts&quot;: {
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;max-size&quot;: &quot;100m&quot;
</span><span style="word-break:break-all;white-space:break-spaces">  },
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;storage-driver&quot;: &quot;overlay2&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;registry-mirrors&quot;: [
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;https://hub-mirror.c.163.com&quot;,
</span><span style="word-break:break-all;white-space:break-spaces">    &quot;https://mirror.baidubce.com&quot;
</span><span style="word-break:break-all;white-space:break-spaces">  ],
</span><span style="word-break:break-all;white-space:break-spaces">  &quot;insecure-registries&quot;: [&quot;192.168.1.38:5000&quot;]
</span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#690">EOF</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Check</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> info </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">grep</span><span> Cgroup
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装Kubernetes</h2>
<img src="./svgs/kubernetes.svg" alt="kubernetes"/>
<blockquote>
<p>Kubeadm</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/yum.repos.d/kubernetes.repo
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">kubernetes</span><span class="token section" style="color:#999">]</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">name</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">Kubernetes</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">baseurl</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">enabled</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">1</span><span> 
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">gpgcheck</span><span class="token" style="color:#999">=</span><span class="token value" style="color:#07a">0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># kubelet</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># yum --showduplicates list kubelet</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">yum remove kubelet
</span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> kubelet-1.19.16-0
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> kubeadm-1.19.16
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>镜像</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 同步Master镜像 (sync.sh) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 初始化参数</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">MY_REGISTRY</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>registry.cn-hangzhou.aliyuncs.com/google_containers
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># MY_REGISTRY=mirrorgcrio</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 kube </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">ETCD_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 etcd </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">PAUSE_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 pause </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">COREDNS_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 coredns </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images from &quot;</span><span class="token" style="color:#e90">$MY_REGISTRY</span><span class="token" style="color:#690">&quot; ......&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm config images list
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 添加标签</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-apiserver:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-scheduler:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-controller-manager:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span> k8s.gcr.io/etcd:</span><span class="token" style="color:#e90">$ETCD_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span> k8s.gcr.io/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span> k8s.gcr.io/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images FINISHED.&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 同步Woker镜像 (sync.sh) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 初始化参数</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">MY_REGISTRY</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>registry.cn-hangzhou.aliyuncs.com/google_containers
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># MY_REGISTRY=mirrorgcrio</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 kube </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">ETCD_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 etcd </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">PAUSE_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 pause </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token assign-left" style="color:#e90">COREDNS_VERSION</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#e90">$(</span><span class="token" style="color:#e90">kubeadm config images list </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">grep</span><span class="token" style="color:#e90"> -m1 coredns </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#e90"> </span><span class="token" style="color:#DD4A68">awk</span><span class="token" style="color:#e90"> -F: </span><span class="token" style="color:#690">&#x27;{print $2}&#x27;</span><span class="token" style="color:#e90">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images from &quot;</span><span class="token" style="color:#e90">$MY_REGISTRY</span><span class="token" style="color:#690">&quot; ......&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;===================================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm config images list
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 添加标签</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span> k8s.gcr.io/kube-proxy:</span><span class="token" style="color:#e90">$VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span> k8s.gcr.io/pause:</span><span class="token" style="color:#e90">$PAUSE_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag </span><span class="token" style="color:#e90">${MY_REGISTRY}</span><span>/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span> k8s.gcr.io/coredns:</span><span class="token" style="color:#e90">$COREDNS_VERSION</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;FewBox Pull Kubernetes &quot;</span><span class="token" style="color:#e90">$VERSION</span><span class="token" style="color:#690">&quot; Images FINISHED.&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;==================================================&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">echo</span><span> </span><span class="token" style="color:#690">&quot;&quot;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Cluster Network</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 设置 (网络) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 防火墙</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop firewalld
</span><span style="word-break:break-all;white-space:break-spaces">systemctl disable firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 将SELinux设置为允许模式（有效地禁用它）。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sudo</span><span> setenforce </span><span class="token" style="color:#905">0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sudo</span><span> </span><span class="token" style="color:#DD4A68">sed</span><span> -i </span><span class="token" style="color:#690">&#x27;s/^SELINUX=enforcing$/SELINUX=permissive/&#x27;</span><span> /etc/selinux/config
</span></span><span style="word-break:break-all;white-space:break-spaces">swapoff -a
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">sed</span><span> -i </span><span class="token" style="color:#690">&#x27;/ swap / s/^\(.*\)$/#\1/g&#x27;</span><span> /etc/fstab
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 桥接</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;&lt;</span><span class="token" style="color:#690">EOF</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#DD4A68">sudo</span><span class="token bash" style="color:#999"> </span><span class="token bash" style="color:#DD4A68">tee</span><span class="token bash" style="color:#999"> /etc/sysctl.d/k8s.conf</span><span class="token" style="color:#690">
</span></span><span style="word-break:break-all;white-space:break-spaces">net.bridge.bridge-nf-call-ip6tables = 1
</span><span style="word-break:break-all;white-space:break-spaces">net.bridge.bridge-nf-call-iptables = 1
</span><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#690">EOF</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Check</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">sysctl --system
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 代理 (Kubelet) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl daemon-reload
</span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> kubelet </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> systemctl restart kubelet
</span></span><span style="word-break:break-all;white-space:break-spaces">journalctl -xefu kubelet
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Kubernetes</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装Master ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Multiple Eth need --apiserver-advertise-address</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubeadm init --pod-network-cidr</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">10.244</span><span>.0.0/16 --kubernetes-version</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">1.19</span><span>.16
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装Worker ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 打印连接脚本</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm token create --print-join-command
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 链接Master</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubeadm </span><span class="token" style="color:#DD4A68">join</span><span> </span><span class="token" style="color:#905">172.17</span><span>.0.1:6443 --token vv4prq.ezm481v2k0oa0273 --discovery-token-ca-cert-hash sha256:bd34337dcab22ce02049d1f98dc73a96729f1a3b9c9d80a3d76e175af1db4e21
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 网络 (Flannel) ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 下载</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">wget</span><span> https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 更改 &quot;net-conf.json &gt; Network&quot; 为 kubernetes podCIDR 10.244.0.0/16</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl cluster-info dump </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">grep</span><span> -m </span><span class="token" style="color:#905">1</span><span> cluster-cidr
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">vi</span><span> kube-flannel.yml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f kube-flannel.yml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># start.sh</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span> </span><span class="token assign-left" style="color:#e90">KUBECONFIG</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>/etc/kubernetes/admin.conf
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">alias</span><span> </span><span class="token assign-left" style="color:#e90">k</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>kubectl  </span><span class="token" style="color:slategray">#~/.bashrc</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">source</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#999">(</span><span>kubectl completion </span><span class="token" style="color:#DD4A68">bash</span><span class="token" style="color:#999">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">source</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span class="token" style="color:#999">(</span><span>kubectl completion </span><span class="token" style="color:#DD4A68">bash</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">sed</span><span>   s/kubectl/k/g</span><span class="token" style="color:#999">)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">alias</span><span> </span><span class="token assign-left" style="color:#e90">kcd</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#690">&#x27;kubectl config set-context $(kubectl   config current-context) --namespace&#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span> </span><span class="token assign-left" style="color:#e90">CALICO_DATASTORE_TYPE</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>kubernetes
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">export</span><span>   </span><span class="token assign-left" style="color:#e90">CALICO_KUBECONFIG</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>/etc/kubernetes/admin.conf
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># export PATH=$PATH:/root/istio-1.6.2/bin/</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 容许tab按键帮助</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum -y </span><span class="token" style="color:#DD4A68">install</span><span> bash-completion
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">bash</span><span> /usr/share/bash-completion/bash_completion
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">bash</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 检测Kubernetes状态 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get cs
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># scheduler            Unhealthy   Get &quot;http://127.0.0.1:10251/healthz&quot;: dial tcp 127.0.0.1:10251: connect:   connection refused   </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># controller-manager   Unhealthy   Get &quot;http://127.0.0.1:10252/healthz&quot;: dial tcp 127.0.0.1:10252: connect:   connection refused</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># Solution: need to remove &quot;--port=0&quot; in kube-controller-manager.yaml  kube-scheduler.yaml   /etc/kubernetes/manifests </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl restart kubelet.service
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 资源 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl describe </span><span class="token" style="color:#DD4A68">node</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl describe </span><span class="token" style="color:#DD4A68">node</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">grep</span><span> -E </span><span class="token" style="color:#690">&#x27;((Name|Roles):\s{6,})|(\s+(memory|cpu)\s+[0-9]+\w{0,2}.+%\))&#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 清理 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl drain </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>node name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> --delete-local-data --force --ignore-daemonsets
</span></span><span style="word-break:break-all;white-space:break-spaces">kubeadm reset
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cd</span><span> /etc/cni/net.d/
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># remove /etc/cni/net.d/</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">lsof</span><span> -i :6443</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">grep</span><span> -v </span><span class="token" style="color:#690">&quot;PID&quot;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">awk</span><span> </span><span class="token" style="color:#690">&#x27;{print &quot;kill -9&quot;,$2}&#x27;</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span class="token" style="color:#DD4A68">sh</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>iptables -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -t nat -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -t mangle -F </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&amp;&amp;</span><span> iptables -X
</span></span><span style="word-break:break-all;white-space:break-spaces">ipvsadm -C
</span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl delete </span><span class="token" style="color:#DD4A68">node</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>node name</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 容许Master部署 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl taint nodes --all node-role.kubernetes.io/master-
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Metric ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull bitnami/metrics-server:0.6.1
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> tag bitnami/metrics-server:0.6.1 k8s.gcr.io/metrics-server/metrics-server:v0.6.1
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">yaml</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-yaml" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Disable Metric Security ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#07a">spec</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token key" style="color:#07a">containers</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:#999">-</span><span> </span><span class="token key" style="color:#07a">args</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>cert</span><span class="token" style="color:#999">-</span><span>dir=/tmp
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>secure</span><span class="token" style="color:#999">-</span><span>port=4443
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token key" style="color:#07a">command</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> /metrics</span><span class="token" style="color:#999">-</span><span>server
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>insecure</span><span class="token" style="color:#999">-</span><span>tls=true
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>preferred</span><span class="token" style="color:#999">-</span><span>address</span><span class="token" style="color:#999">-</span><span>types=InternalIP
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>      </span><span class="token key" style="color:#07a">image</span><span class="token" style="color:#999">:</span><span> k8s.gcr.io/metrics</span><span class="token" style="color:#999">-</span><span>server/metrics</span><span class="token" style="color:#999">-</span><span>server</span><span class="token" style="color:#999">:</span><span>v0.3.7
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">yaml</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-yaml" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### Disable Metric Security ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#07a">args</span><span class="token" style="color:#999">:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>cert</span><span class="token" style="color:#999">-</span><span>dir=/tmp
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>secure</span><span class="token" style="color:#999">-</span><span>port=4443
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>preferred</span><span class="token" style="color:#999">-</span><span>address</span><span class="token" style="color:#999">-</span><span>types=InternalIP</span><span class="token" style="color:#999">,</span><span>ExternalIP</span><span class="token" style="color:#999">,</span><span>Hostname
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>use</span><span class="token" style="color:#999">-</span><span>node</span><span class="token" style="color:#999">-</span><span>status</span><span class="token" style="color:#999">-</span><span>port
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>  </span><span class="token" style="color:#999">-</span><span> </span><span class="token" style="color:#999">-</span><span class="token" style="color:#999">-</span><span>kubelet</span><span class="token" style="color:#999">-</span><span>insecure</span><span class="token" style="color:#999">-</span><span>tls </span><span class="token" style="color:slategray"># 添加这一行（新版本）。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 检测Metric ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl </span><span class="token" style="color:#DD4A68">top</span><span> </span><span class="token" style="color:#DD4A68">node</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>kubectl </span><span class="token" style="color:#DD4A68">top</span><span> pod
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>Install Istio</h2>
<img src="./svgs/istio.svg" alt="istio"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -L https://istio.io/downloadIstio </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> </span><span class="token" style="color:#DD4A68">sh</span><span> -
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl </span><span class="token" style="color:#DD4A68">install</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 插件 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/prometheus.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/grafana.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/jaeger.yaml
</span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f ./samples/addons/kiali.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 概况 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># istioctl install --set profile=demo</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">istioctl profile list
</span><span style="word-break:break-all;white-space:break-spaces">istioctl profile dump default
</span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl profile </span><span class="token" style="color:#DD4A68">diff</span><span> default demo
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 验证 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl manifest generate </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token environment" style="color:#905">$HOME</span><span>/generated-manifest.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl verify-install -f </span><span class="token environment" style="color:#905">$HOME</span><span>/generated-manifest.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 卸载 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 所有</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">istioctl x uninstall --purge
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 控制平面</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl x uninstall </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>your original installation options</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>istioctl manifest generate </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&lt;</span><span>your original installation options</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">&gt;</span><span> </span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">|</span><span> kubectl delete -f -
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 命名空间</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl delete namespace istio-system
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># </span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装NFS</h2>
<blockquote>
<p>NFS</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum -y </span><span class="token" style="color:#DD4A68">install</span><span> nfs-utils rpcbind
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">mkdir</span><span> -p /data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">chmod</span><span> </span><span class="token" style="color:#905">755</span><span> /data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">vi</span><span> /etc/exports
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># /etc/exports</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># /data/k8s 192.168.1.0/24(rw,sync,no_root_squash) // /data/k8s *(rw,sync,no_root_squash)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -v telnet://192.168.1.38:2049
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 启动服务 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> rpcbind
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> nfs
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl start rpcbind
</span><span style="word-break:break-all;white-space:break-spaces">systemctl start nfs
</span><span style="word-break:break-all;white-space:break-spaces">rpcinfo -p
</span><span style="word-break:break-all;white-space:break-spaces">exportfs -r
</span><span style="word-break:break-all;white-space:break-spaces">exportfs
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Kubernetes</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 重要!!! 需要安装在Master节点（可选）和Worker节点。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nfs-utils
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>Test</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 客户端 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nfs-common nfs-utils -y
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 挂载 &amp; 卸载 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">mount</span><span> -t nfs </span><span class="token" style="color:#905">192.168</span><span>.1.38:/NFS/k8s /mount/nfs </span><span class="token" style="color:slategray"># Master和Worker节点，都指向NFS服务器。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mount -t nfs 192.168.1.38:/data/k8s /mount/nfs # Master和Worker节点，都指向NFS服务器。</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mount -t nfs 192.168.1.38:/NFS/nginx /mount/nfs</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">curl</span><span> -v telnet://192.168.1.38:2049
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">umount</span><span> -f -l /mount/data/k8s
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装Nginx</h2>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">### 安装 ###</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>yum </span><span class="token" style="color:#DD4A68">install</span><span> nginx
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 设置防火墙</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl status firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --add-port</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">80</span><span>/tcp --permanent
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray">#user  nginx;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#user  root; # Permission Issue.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Defines which Linux system user will own and run the Nginx server</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">worker_processes  1;
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Referes to single threaded process. Generally set to be equal to the number of CPUs or cores.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#error_log  logs/error.log; #error_log  logs/error.log  notice;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Specifies the file where server logs.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#pid        logs/nginx.pid;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#nginx will write its master process ID(PID).</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">events {
</span><span style="word-break:break-all;white-space:break-spaces">    worker_connections  1024;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># worker_processes and worker_connections allows you to calculate maxclients value:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># max_clients = worker_processes * worker_connections</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">http {
</span><span style="word-break:break-all;white-space:break-spaces">    ssl_certificate /etc/ssl/fewbox.crt;
</span><span style="word-break:break-all;white-space:break-spaces">    ssl_certificate_key /etc/ssl/fewbox.key;
</span><span style="word-break:break-all;white-space:break-spaces">    upstream istio {
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.3:30815;
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.4:30815;
</span><span style="word-break:break-all;white-space:break-spaces">        server 172.17.6.5:30815;
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    include       mime.types;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># anything written in /opt/nginx/conf/mime.types is interpreted as if written inside the http { } block</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    default_type  application/octet-stream;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_connect_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_send_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    fastcgi_read_timeout 600;
</span><span style="word-break:break-all;white-space:break-spaces">    client_max_body_size 200M;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_connect_timeout       600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_send_timeout          600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_read_timeout          600;
</span><span style="word-break:break-all;white-space:break-spaces">    proxy_http_version 1.1;
</span><span style="word-break:break-all;white-space:break-spaces">    send_timeout                600;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#access_log  logs/access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    sendfile        on;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># If serving locally stored static files, sendfile is essential to speed up the server,</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># But if using as reverse proxy one can deactivate it</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#tcp_nopush     on;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># works opposite to tcp_nodelay. Instead of optimizing delays, it optimizes the amount of data sent at   once.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#keepalive_timeout  0;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    keepalive_timeout  65;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># timeout during which a keep-alive client connection will stay open.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    gzip  on;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_min_length 1k;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_buffers 4 16k;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_comp_level 5;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_types gzip_types text/plain application/javascript application/x-javascript text/css   application/xml text/javascript application/x-httpd-php;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_http_version 1.1;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_vary on;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_proxied any;
</span><span style="word-break:break-all;white-space:break-spaces">    gzip_disable msie6;
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># tells the server to use on-the-fly gzip compression.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    server {
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># You would want to make a separate file with its own server block for each virtual domain</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># on your server and then include them.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        listen       80;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#tells Nginx the hostname and the TCP port where it should listen for HTTP connections.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># listen 80; is equivalent to listen *:80;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        server_name  _;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># lets you doname-based virtual hosting</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        charset utf-8;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#access_log  logs/host.access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        return 302 https://$server_name$request_uri;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#error_page  404              /404.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># redirect server error pages to the static page /50x.html</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        error_page   500 502 503 504  /50x.html;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token key" style="color:#690">location</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/50x.html {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            root   html;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    proxy_pass   http://127.0.0.1;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    root           html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_pass   127.0.0.1:9000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_index  index.php;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    include        fastcgi_params;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># deny access to .htaccess files, if Apache&#x27;s document root</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># concurs with nginx&#x27;s one</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ /\.ht {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    deny  all;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">    server
</span><span style="word-break:break-all;white-space:break-spaces">    {
</span><span style="word-break:break-all;white-space:break-spaces">        listen 443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces">        server_name _;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header Host  $host;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header X-Forwarded-For $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-Real-IP $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Host $host:$server_port;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header X-NginX-Proxy true;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_pass http://istio;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    server
</span><span style="word-break:break-all;white-space:break-spaces">    {
</span><span style="word-break:break-all;white-space:break-spaces">        listen 8443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces">        server_name _;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header Host $host;
</span><span style="word-break:break-all;white-space:break-spaces">        proxy_set_header X-Forwarded-For $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_pass https://172.17.6.3:6443; # Your Api Server Address
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">                proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">    server {
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># You would want to make a separate file with its own server block for each virtual domain</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># on your server and then include them.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        listen 7443 ssl;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#tells Nginx the hostname and the TCP port where it should listen for HTTP connections.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># listen 80; is equivalent to listen *:80;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        server_name  _;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># lets you doname-based virtual hosting</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        charset utf-8;
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#access_log  logs/host.access.log  main;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">        location / {
</span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#The location setting lets you configure how nginx responds to requests for resources within the   server.</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#root   /usr/share/nginx/html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#index  index.html index.htm;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#try_files $uri /index.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-Real-IP $remote_addr;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Host $host:$server_port;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header X-NginX-Proxy true;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Upgrade $http_upgrade;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_set_header Connection &quot;upgrade&quot;;
</span><span style="word-break:break-all;white-space:break-spaces">            proxy_pass http://istio;
</span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_set_header Host  $host;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_set_header X-Forwarded-For $remote_addr;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>            </span><span class="token" style="color:slategray">#proxy_pass http://istio;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#error_page  404              /404.html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># redirect server error pages to the static page /50x.html</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">        error_page   500 502 503 504  /50x.html;
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token key" style="color:#690">location</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/50x.html {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">            root   html;
</span><span style="word-break:break-all;white-space:break-spaces">        }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    proxy_pass   http://127.0.0.1;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ \.php$ {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    root           html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_pass   127.0.0.1:9000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_index  index.php;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    include        fastcgi_params;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># deny access to .htaccess files, if Apache&#x27;s document root</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray"># concurs with nginx&#x27;s one</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#location ~ /\.ht {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#    deny  all;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>        </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">    }
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray"># another virtual host using mix of IP-, name-, and port-based configuration</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#server {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    listen       8000;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    listen       somename:8080;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    server_name  somename  alias  another.alias;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    location / {</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#        root   html;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#        index  index.html index.htm;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#    }</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>    </span><span class="token" style="color:slategray">#}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">}
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装SSL</h2>
<blockquote>
<p>Let&#x27;s Encrypt (<a href="https://letsencrypt.org/">https://letsencrypt.org/</a>)</p>
<p>Cerbot (<a href="https://certbot.eff.org/">https://certbot.eff.org/</a>)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 生成带有密码的SSL私钥 (fewbox-pw.key)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>openssl genrsa -des3 -out fewbox-pw.key </span><span class="token" style="color:#905">2048</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看带有密码的私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl rsa -text -in fewbox-pw.key
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看带有密码的私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">cat</span><span> fewbox-pw.key
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成CSR(fewbox.csr)证书签名请求</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl req -new -key fewbox-pw.key -out fewbox.csr
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看CSR</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl req -text -in fewbox.csr -noout
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成CRT（ fewbox.crt）证书</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>openssl x509 -req -days </span><span class="token" style="color:#905">365</span><span> -in fewbox.csr -signkey fewbox-pw.key -out fewbox.crt
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 生成SSL私钥</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">openssl rsa -in fewbox-pw.key -out fewbox.key
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>设置防火墙</h2>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 查看状态</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl status firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 重启</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 开机启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> firewalld
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 禁止开机启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">sytemctl disable firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 启动</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl start firewalld 
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 关闭</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop firewalld
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看区域</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --get-active-zones
</span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --get-zone-of-interface</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>enp0s3
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看拒绝数据包状态</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --query-panic
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 拒绝所有数据包</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --panic-on
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 容许所有数据包</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --panic-off
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 查看端口号</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --list-ports
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 打开端口</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>firewall-cmd --zone</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span>public --add-port</span><span class="token" style="color:#9a6e3a;background:hsla(0, 0%, 100%, .5)">=</span><span class="token" style="color:#905">80</span><span>/tcp --permanent
</span></span><span style="word-break:break-all;white-space:break-spaces">firewall-cmd --reload
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 其他</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --zone=public --add-interface=eth0 (FOREVER add &#x27;--permanent&#x27; and then reload firewall)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --set-default-zone=public (Valiable immediately, no need rebot)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># firewall-cmd --reload orfirewall-cmd --complete-reload (No1 no need diconnect, No2 need disconnect as reboot)</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
<li>
<h2>安装FRP (可选)</h2>
<blockquote>
<p>下载</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># https://github.com/fatedier/frp/releases</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># amd64</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">wget</span><span> https://github.com/fatedier/frp/releases/download/v0.44.0/frp_0.44.0_linux_amd64.tar.gz
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>服务端 (拥有公网IP)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># https://gofrp.org/docs/examples/ frps.ini</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">common</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">bind_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">vhost_http_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">8080</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">vhost_https_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">8081</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">log_file</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">console</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_addr</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">0.0.0.0</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7500</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_user</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">fewbox</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">dashboard_pwd</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Pwd}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">token</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Token}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">max_pool_count</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">50</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/systemd/system/frps.service
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Unit</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Description</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">frp server</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">After</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">network.target syslog.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Wants</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">network.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Service</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">Type</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">simple</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">ExecStart</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">/path/to/frps -c /path/to/frps.ini</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">Install</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">WantedBy</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">multi-user.target</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>systemctl start frps
</span></span><span style="word-break:break-all;white-space:break-spaces">systemctl stop frps
</span><span style="word-break:break-all;white-space:break-spaces">systemctl restart frps
</span><span style="word-break:break-all;white-space:break-spaces">systemctl status frps
</span><span style="word-break:break-all;white-space:break-spaces"><span>systemctl </span><span class="token" style="color:#DD4A68">enable</span><span> frps
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>客户端 (内部机器出口)</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 拉取镜像</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">docker</span><span> pull fatedier/frpc
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">ini</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-ini" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">common</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">server_addr</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Server IP}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">server_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">7000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">token</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Your Token}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token section" style="color:#999">[</span><span class="token section section-name" style="color:#690">web</span><span class="token section" style="color:#999">]</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">type</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">http</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">local_ip</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">{Local IP: EG. nginx}</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">local_port</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">5000</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token key" style="color:#690">custom_domains</span><span> </span><span class="token" style="color:#999">=</span><span> </span><span class="token value" style="color:#07a">*.fewbox.com</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<h3><strong>NAS</strong></h3>
<p>Command: -c /frpc/frpc.ini</p>
<p>Endpoint: /usr/bin/frpc</p>
<p>Share Folder: /DevOps/frpc /frpc</p>
</blockquote>
</li>
<li>
<h2>安装esxi (可选)</h2>
<blockquote>
<p><a href="https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=gn51y&amp;lwp=rt">https://www.dell.com/support/home/en-us/drivers/driversdetails?driverid=gn51y&amp;lwp=rt</a></p>
</blockquote>
</li>
</ul></div><div id="packing-table" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装包装台</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>域，NFS，名称空间，服务账户，集群角色绑定，打包表</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 安装</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:#DD4A68">.</span><span> ./fewbox-install.sh
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 检测</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get ns fewbox-system
</span><span style="word-break:break-all;white-space:break-spaces">k get sa fewbox
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get clusterrolebinding fewbox </span><span class="token" style="color:slategray"># cluster-admin - fewbox/fewbox-admin</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get cm packingtable
</span><span style="word-break:break-all;white-space:break-spaces">k get crd packingtables.fewbox.com
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy packingtable
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="infrastructure" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装基础设施</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>名称空间，服务账户，集群角色，集群角色绑定，NFS供应者，NFS存储类</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>k create -f ./component/infrastructure/fewbox-infrastructure.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>kcd fewbox
</span></span><span style="word-break:break-all;white-space:break-spaces">k get ns fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get sa nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrole nfs-client-provisioner-runner
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrolebinding run-nfs-client-provisioner-fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces">k get sc managed-nfs-storage
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="third-party" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装第三方</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<blockquote>
<p>RabbitMQ: CRD, ClusterRole, Service Account, Role Binding, Cluster Role Binding, Deployment, Virtual Service, RMQ</p>
<p>MySQL: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
<p>Redis: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
<p>MongoDB: PVC, Deployment, Service, Destination Rule, Virtual Service</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:#DD4A68">vi</span><span> /etc/kubernetes/manifests/kube-apiserver.yaml
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Under here:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#spec:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#containers:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#- command:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span> </span><span class="token" style="color:slategray">#  - kube-apiserver</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#Add this line:</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#- --feature-gates=RemoveSelfLink=false</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<blockquote>
<p>测试</p>
</blockquote>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span>k get pvc mysql
</span></span><span style="word-break:break-all;white-space:break-spaces">k get pvc npmregistry
</span><span style="word-break:break-all;white-space:break-spaces">k get pvc redis
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get </span><span class="token" style="color:#DD4A68">pv</span><span> </span><span class="token" style="color:slategray"># From PVC</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get cm npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>k get cm rabbitmq-cluster-operator-leader-election  </span><span class="token" style="color:slategray">#??</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get deploy mysql
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy nfs-client-provisioner
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get deploy npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get deploy rabbitmq-cluster-operator
</span><span style="word-break:break-all;white-space:break-spaces">k get deploy redis
</span><span style="word-break:break-all;white-space:break-spaces">k get svc mysql
</span><span style="word-break:break-all;white-space:break-spaces">k get svc npmregistry
</span><span style="word-break:break-all;white-space:break-spaces">k get svc redis
</span><span style="word-break:break-all;white-space:break-spaces">k get dr mysql
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get dr npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get dr redis
</span><span style="word-break:break-all;white-space:break-spaces">k get vs mysql
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray">#k get vs npmregistry</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get vs redis
</span><span style="word-break:break-all;white-space:break-spaces">k get vs rabbitmq-client
</span><span style="word-break:break-all;white-space:break-spaces">k get crd rabbitmqclusters.rabbitmq.com
</span><span style="word-break:break-all;white-space:break-spaces">k get clusterrole rabbitmq-cluster-operator-role
</span><span style="word-break:break-all;white-space:break-spaces">k get sa rabbitmq-cluster-operator
</span><span style="word-break:break-all;white-space:break-spaces"><span>k get rolebinding rabbitmq-cluster-leader-election-rolebinding </span><span class="token" style="color:slategray"># rabbitmq-cluster-leader-election-role -   rabbitmq-cluster-operator</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k get clusterrolebinding rabbitmq-cluster-operator-rolebinding-fewbox
</span><span style="word-break:break-all;white-space:break-spaces">k get vs rabbitmq-client
</span><span style="word-break:break-all;white-space:break-spaces">k get rmq fewbox
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 测试MySQL</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span>k </span><span class="token" style="color:#DD4A68">exec</span><span> -it fewbox-mysql-0 </span><span class="token" style="color:#DD4A68">bash</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># SQL &gt;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># mysqlsh fewbox@localhost --sql</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># set global read_only=0;</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k port-forward service/fewbox-mysql-instances mysql
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="foundation" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><ul>
<li>
<h2>安装基本组件</h2>
<img src="./svgs/fewbox.svg" alt="fewbox"/>
<pre><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-stretch flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-space-between flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><span class="flex-item v-label dark-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">shell</span><svg viewBox="0 0 256 256" fill="none" xmlns="http://www.w3.org/2000/svg" class="flex-item v-svg-default font-size-small primary-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:pointer"><path d="M213.714 70.857h-21.428v100a21.45 21.45 0 0 1-6.284 15.145 21.45 21.45 0 0 1-15.145 6.284h-100v21.429a14.31 14.31 0 0 0 4.189 10.097A14.31 14.31 0 0 0 85.143 228h128.571a14.306 14.306 0 0 0 10.097-4.188A14.311 14.311 0 0 0 228 213.715V85.143a14.306 14.306 0 0 0-14.286-14.286z" fill="currentColor"></path><path d="M70.857 185.143h100a14.31 14.31 0 0 0 10.097-4.189 14.31 14.31 0 0 0 4.189-10.097V42.286a14.31 14.31 0 0 0-4.189-10.097A14.308 14.308 0 0 0 170.857 28H42.286a14.308 14.308 0 0 0-10.097 4.189A14.31 14.31 0 0 0 28 42.286v128.571a14.308 14.308 0 0 0 4.189 10.097 14.31 14.31 0 0 0 10.097 4.189h28.571z" fill="currentColor"></path></svg></div><div class="flex-item v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><pre style="color:black;background:#f5f2f0;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto"><code class="language-shell" style="color:black;background:none;text-shadow:0 1px white;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, &#x27;Ubuntu Mono&#x27;, monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span style="word-break:break-all;white-space:break-spaces"><span class="token" style="color:slategray"># 数据库模式</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k create -f ./component/foundation/fewbox-foundation-schema.yaml
</span><span style="word-break:break-all;white-space:break-spaces"><span></span><span class="token" style="color:slategray"># 应用</span><span>
</span></span><span style="word-break:break-all;white-space:break-spaces">k create -f ./component/foundation/fewbox-foundation.yaml
</span><span style="word-break:break-all;white-space:break-spaces"></span></code></pre></div></div></pre>
</li>
</ul></div><div id="how-to-use" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>怎样使用</h1>
<blockquote>
<p>即将开放</p>
<p><a href="./service"><strong>联系我们</strong></a></p>
</blockquote></div><div id="about-us" class="v-boundary" style="font-family:&#x27;Orbitron&#x27;, sans-serif"><h1>关于我们</h1>
<p>由一个曾在大型公司和创业公司（联想、JD、BoostSolutions）担任过架构师的老家伙创立，但现在我正在创建一个小而美的公司。</p>
<p>我们正在为那些想要变得聪明的客户建立智能套件。</p></div></div></section></div></div><div class="v-ybase flex flex-direction-column flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="padding:1em;font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:1em"><div class="flex-item v-xbase flex flex-wrap-nowrap flex-justify-content-flex-start flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:1em"><a class="flex-item v-link" style="flex-grow:1;font-family:&#x27;Orbitron&#x27;, sans-serif" href="https://discord.com/channels/966528814245097522/966528814698090568" target="_blank"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-center flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:0.6em"><span class="flex-item v-label" style="font-family:&#x27;Orbitron&#x27;, sans-serif"></span></div><svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="v-svg-default font-size-small placeholder-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><path d="M26.82 5.96c3.439 5.057 5.137 10.76 4.502 17.327a.099.099 0 0 1-.04.07 25.174 25.174 0 0 1-7.616 3.843.098.098 0 0 1-.107-.037 20.305 20.305 0 0 1-1.554-2.528.097.097 0 0 1 .051-.135 15.69 15.69 0 0 0 2.377-1.13.098.098 0 0 0 .009-.163c-.161-.12-.32-.245-.474-.37a.093.093 0 0 0-.099-.013c-4.925 2.275-10.32 2.275-15.305 0a.095.095 0 0 0-.098.014c-.152.125-.312.25-.472.37a.097.097 0 0 0 .01.161 16.61 16.61 0 0 0 2.376 1.132c.053.02.079.082.052.134-.448.887-.97 1.73-1.555 2.53a.1.1 0 0 1-.107.035c-2.477-.77-5-1.93-7.605-3.843a.103.103 0 0 1-.04-.071c-.53-5.68.552-11.431 4.5-17.327a.089.089 0 0 1 .04-.035 25.057 25.057 0 0 1 6.2-1.922.098.098 0 0 1 .099.047c.268.476.576 1.086.784 1.585 2.292-.35 4.62-.35 6.962 0 .207-.489.504-1.11.771-1.585a.094.094 0 0 1 .1-.047 25.116 25.116 0 0 1 6.199 1.922c.017.007.03.019.04.036zm-12.907 10.8c.024-1.68-1.2-3.07-2.737-3.07-1.524 0-2.736 1.378-2.736 3.07 0 1.69 1.236 3.067 2.736 3.067 1.525 0 2.737-1.377 2.737-3.068zm10.119 0c.024-1.68-1.2-3.07-2.737-3.07-1.524 0-2.737 1.378-2.737 3.07 0 1.69 1.237 3.067 2.737 3.067 1.537 0 2.737-1.377 2.737-3.068z" fill="currentColor"></path></svg></a><a class="flex-item v-link" style="flex-grow:1;font-family:&#x27;Orbitron&#x27;, sans-serif" href="https://twitter.com/fewbox" target="_blank"><div class="v-xbase flex flex-wrap-nowrap flex-justify-content-center flex-align-items-center flex-align-content-flex-start" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit;gap:0.6em"><span class="flex-item v-label" style="font-family:&#x27;Orbitron&#x27;, sans-serif"></span></div><svg viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="v-svg-default font-size-small placeholder-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif;cursor:inherit"><path d="M9.75 28.203c11.698 0 18.095-9.695 18.095-18.103 0-.275-.005-.55-.018-.822A12.936 12.936 0 0 0 31 5.983c-1.14.507-2.366.848-3.652 1.002a6.385 6.385 0 0 0 2.796-3.52 12.754 12.754 0 0 1-4.038 1.545 6.362 6.362 0 0 0-10.838 5.802 18.058 18.058 0 0 1-13.11-6.647 6.347 6.347 0 0 0-.862 3.198 6.358 6.358 0 0 0 2.83 5.296 6.31 6.31 0 0 1-2.88-.796l-.001.081a6.363 6.363 0 0 0 5.103 6.237 6.364 6.364 0 0 1-2.873.11 6.367 6.367 0 0 0 5.941 4.418 12.757 12.757 0 0 1-7.899 2.724A13.04 13.04 0 0 1 0 25.345a17.998 17.998 0 0 0 9.75 2.858" fill="currentColor"></path></svg></a></div><span class="flex-item v-label font-size-extra-small placeholder-front" style="font-family:&#x27;Orbitron&#x27;, sans-serif">版权所有 © 2023 FewBox， 侵权必究</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/document","query":{},"buildId":"naW9V0KzJIRYqVhWn_sKl","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>